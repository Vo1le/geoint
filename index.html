<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OSINT Platform Â· Geo Intelligence</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"/>
<link rel="stylesheet" href="css/main.css">
</head>
<body>
<div id="app">

  <!-- TOPBAR -->
  <header id="topbar">
    <div class="logo">OSINT<span>Â·GEO</span></div>
    <nav class="nav-tabs">
      <button class="nav-tab active" data-view="map" onclick="App.setView('map')"><span class="dot"></span>CARTE</button>
      <button class="nav-tab" data-view="osint" onclick="App.setView('osint')"><span class="dot"></span>OUTILS OSINT</button>
      <button class="nav-tab" data-view="graph" onclick="App.setView('graph')"><span class="dot"></span>GRAPHE</button>
      <button class="nav-tab" data-view="table" onclick="App.setView('table')"><span class="dot"></span>DONNÃ‰ES</button>
    </nav>
    <div class="topbar-right">
      <span class="badge badge-live" id="live-badge">â¬¤ LIVE</span>
      <span class="badge badge-api" id="api-badge">API</span>
      <button class="icon-btn" onclick="App.openExport()" title="Exporter">â¬‡</button>
      <button class="icon-btn" onclick="App.refreshAll()" title="Actualiser tout">â†»</button>
    </div>
  </header>

  <!-- LEFT SIDEBAR -->
  <aside id="sidebar-left">
    <div class="sb-section">
      <div class="search-wrap">
        <span class="search-ic">ğŸ”</span>
        <input id="search-input" class="search-inp" placeholder="IP, domaine, callsign..." autocomplete="off">
        <button class="search-go" onclick="App.quickSearch()">â†’</button>
      </div>
    </div>

    <div class="sb-section">
      <div class="sb-label">Statistiques <span class="count" id="total-count">0</span></div>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-val blue" id="s-flights">0</div>
          <div class="stat-lbl">âœˆ Vols chargÃ©s</div>
          <div class="stat-sub" id="s-viewport">0 Ã  l'Ã©cran</div>
        </div>
        <div class="stat-card"><div class="stat-val red" id="s-incidents">0</div><div class="stat-lbl">âš  Incidents</div></div>
        <div class="stat-card"><div class="stat-val cyan" id="s-infra">0</div><div class="stat-lbl">ğŸ“¡ Infra</div></div>
        <div class="stat-card"><div class="stat-val orange" id="s-traffic">0</div><div class="stat-lbl">ğŸ›£ Traffic</div></div>
      </div>
      <div class="risk-wrap">
        <div class="risk-head">
          <span class="risk-lbl">Score exposition</span>
          <button class="risk-info-btn" onclick="App.toggleRiskInfo()">?</button>
          <span class="risk-num" id="risk-num">0</span>
        </div>
        <div class="risk-track"><div class="risk-fill" id="risk-fill"></div></div>
        <div id="risk-info" class="risk-info" style="display:none">
          <div class="ri-row"><span class="ri-dot" style="background:#3fb950"></span><b>0â€“25 Faible</b> â€” trafic normal</div>
          <div class="ri-row"><span class="ri-dot" style="background:#e3b341"></span><b>26â€“50 ModÃ©rÃ©</b> â€” incidents mineurs</div>
          <div class="ri-row"><span class="ri-dot" style="background:#f78166"></span><b>51â€“75 Ã‰levÃ©</b> â€” anomalies corrÃ©lÃ©es</div>
          <div class="ri-row"><span class="ri-dot" style="background:#f85149"></span><b>76â€“100 Critique</b> â€” incidents multiples</div>
        </div>
      </div>
    </div>

    <div class="sb-section">
      <div class="sb-label">Couches</div>
      <div class="layer-row" onclick="App.toggleLayer('aviation')"><div class="layer-toggle on" id="lt-aviation"></div><span class="layer-ic">âœˆ</span><div class="layer-info"><div class="layer-name">Trafic aÃ©rien</div><div class="layer-sub">OpenSky Â· Global</div></div></div>
      <div class="layer-row" onclick="App.toggleLayer('incidents')"><div class="layer-toggle on" id="lt-incidents"></div><span class="layer-ic">âš </span><div class="layer-info"><div class="layer-name">Incidents gÃ©o</div><div class="layer-sub">GDACS Â· 30 zones</div></div></div>
      <div class="layer-row" onclick="App.toggleLayer('infra')"><div class="layer-toggle on" id="lt-infra"></div><span class="layer-ic">ğŸ“¡</span><div class="layer-info"><div class="layer-name">Infrastructure</div><div class="layer-sub">ASN Â· Datacenters</div></div></div>
      <div class="layer-row" onclick="App.toggleLayer('traffic')"><div class="layer-toggle" id="lt-traffic"></div><span class="layer-ic">ğŸ›£</span><div class="layer-info"><div class="layer-name">Trafic routier</div><div class="layer-sub">OSM Â· 80+ villes</div></div></div>
      <div class="layer-row" onclick="App.toggleLayer('heatmap')"><div class="layer-toggle" id="lt-heatmap"></div><span class="layer-ic">ğŸ”¥</span><div class="layer-info"><div class="layer-name">Heatmap densitÃ©</div></div></div>
    </div>

    <div class="sb-section">
      <div class="sb-label">Filtres vols</div>
      <div class="filter-row"><label class="filter-lbl">Alt min <span id="alt-val">0 ft</span></label><input type="range" class="frange" min="0" max="45000" value="0" oninput="App.setFilter('alt',this.value)"></div>
      <div class="filter-row"><label class="filter-lbl">Vitesse min <span id="spd-val">0 kts</span></label><input type="range" class="frange" min="0" max="600" value="0" oninput="App.setFilter('spd',this.value)"></div>
    </div>

    <!-- Multi-tracking panel -->
    <div id="tracked-panel" class="sb-section" style="display:none"></div>
  </aside>

  <!-- MAIN AREA -->
  <main id="main-area">

    <!-- MAP VIEW -->
    <div id="view-map" class="view" style="display:block">
      <div id="map"></div>
      <div class="map-tr">
        <button class="map-btn" onclick="MapCtrl.resetView()">ğŸŒ Reset</button>
        <button class="map-btn" onclick="App.refreshAll()">â†» Actualiser</button>
        <div class="coord-box" id="coord-box">â€” / â€”</div>
      </div>
      <div class="map-legend">
        <div class="leg-item"><span class="leg-dot" style="background:#58a6ff"></span>Vol</div>
        <div class="leg-item"><span class="leg-dot" style="background:#00ffcc;box-shadow:0 0 6px #00ffcc"></span>Suivi</div>
        <div class="leg-item"><span class="leg-dot" style="background:#f85149"></span>Incident</div>
        <div class="leg-item"><span class="leg-dot" style="background:#00d4aa"></span>Infra</div>
        <div class="leg-item"><span class="leg-dot" style="background:#f78166"></span>Traffic</div>
      </div>
    </div>

    <!-- OSINT TOOLS VIEW -->
    <div id="view-osint" class="view" style="display:none;flex-direction:column">
      <div class="osint-layout">
        <!-- Categories -->
        <div class="osint-cats">
          <div class="cat-title">CatÃ©gories</div>
          <button class="cat-btn active" data-cat="network" onclick="App.setCat('network')">ğŸŒ RÃ©seau & IP</button>
          <button class="cat-btn" data-cat="domain" onclick="App.setCat('domain')">ğŸ”— Domaines & DNS</button>
          <button class="cat-btn" data-cat="tls" onclick="App.setCat('tls')">ğŸ” TLS & Certs</button>
          <button class="cat-btn" data-cat="threat" onclick="App.setCat('threat')">â˜£ Threat Intel</button>
          <button class="cat-btn" data-cat="image" onclick="App.setCat('image')">ğŸ–¼ Images & MÃ©dias</button>
          <button class="cat-btn" data-cat="social" onclick="App.setCat('social')">ğŸ‘¤ OSINT Social</button>
          <button class="cat-btn" data-cat="geo" onclick="App.setCat('geo')">ğŸ“ GÃ©olocalisation</button>
          <button class="cat-btn" data-cat="breach" onclick="App.setCat('breach')">ğŸ’€ Breaches</button>
          <button class="cat-btn" data-cat="crypto" onclick="App.setCat('crypto')">â‚¿ Crypto</button>
          <button class="cat-btn" data-cat="misc" onclick="App.setCat('misc')">ğŸ›  Utilitaires</button>
        </div>

        <!-- Tool panel -->
        <div class="osint-panel" id="osint-panel">

          <!-- NETWORK -->
          <div class="tool-cat" id="cat-network">
            <div class="tool-cat-title">ğŸŒ RÃ©seau & IP</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">IP Geolocation</div><div class="tool-desc">GÃ©oloc, ASN, org, timezone via ipapi.co</div><input class="tool-inp" id="ip-geo-input" placeholder="8.8.8.8"><button class="tool-btn" onclick="OsintTools.ipGeo()">Analyser</button><div class="tool-result" id="ip-geo-result"></div></div>
              <div class="tool-card"><div class="tool-name">Shodan InternetDB</div><div class="tool-desc">Ports ouverts, CVEs, hostnames</div><input class="tool-inp" id="shodan-input" placeholder="1.1.1.1"><button class="tool-btn" onclick="OsintTools.shodanDB()">Scanner</button><div class="tool-result" id="shodan-result"></div></div>
              <div class="tool-card"><div class="tool-name">ASN Lookup</div><div class="tool-desc">Organisation, pays, RIR via bgpview.io</div><input class="tool-inp" id="asn-input" placeholder="AS15169 ou numÃ©ro"><button class="tool-btn" onclick="OsintTools.asnLookup()">Rechercher</button><div class="tool-result" id="asn-result"></div></div>
              <div class="tool-card"><div class="tool-name">BGP PrÃ©fixes</div><div class="tool-desc">Plages IP annoncÃ©es par un ASN</div><input class="tool-inp" id="bgp-input" placeholder="AS15169"><button class="tool-btn" onclick="OsintTools.bgpLookup()">Voir prÃ©fixes</button><div class="tool-result" id="bgp-result"></div></div>
              <div class="tool-card"><div class="tool-name">Ports & Services</div><div class="tool-desc">Services dÃ©tectÃ©s via Shodan InternetDB</div><input class="tool-inp" id="portscan-input" placeholder="1.1.1.1"><button class="tool-btn" onclick="OsintTools.portInfo()">Voir ports</button><div class="tool-result" id="portscan-result"></div></div>
              <div class="tool-card"><div class="tool-name">Calculatrice rÃ©seau</div><div class="tool-desc">CIDR, masque, plage, broadcast</div><input class="tool-inp" id="netcalc-input" placeholder="192.168.1.0/24"><button class="tool-btn" onclick="OsintTools.networkCalc()">Calculer</button><div class="tool-result" id="netcalc-result"></div></div>
            </div>
          </div>

          <!-- DOMAIN -->
          <div class="tool-cat" id="cat-domain" style="display:none">
            <div class="tool-cat-title">ğŸ”— Domaines & DNS</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">DNS Lookup</div><div class="tool-desc">RequÃªte DNS via Google DoH (A/AAAA/MX/NS/TXT/SOA/CNAME)</div><input class="tool-inp" id="dns-input" placeholder="exemple.com"><div class="type-select-row"><button class="type-sel active" data-dtype="A" onclick="App.selDnsType(this)">A</button><button class="type-sel" data-dtype="AAAA" onclick="App.selDnsType(this)">AAAA</button><button class="type-sel" data-dtype="MX" onclick="App.selDnsType(this)">MX</button><button class="type-sel" data-dtype="NS" onclick="App.selDnsType(this)">NS</button><button class="type-sel" data-dtype="TXT" onclick="App.selDnsType(this)">TXT</button><button class="type-sel" data-dtype="SOA" onclick="App.selDnsType(this)">SOA</button><button class="type-sel" data-dtype="CNAME" onclick="App.selDnsType(this)">CNAME</button></div><button class="tool-btn" onclick="OsintTools.dnsLookup()">RÃ©soudre</button><div class="tool-result" id="dns-result"></div></div>
              <div class="tool-card"><div class="tool-name">WHOIS / RDAP</div><div class="tool-desc">Registrant, dates, nameservers</div><input class="tool-inp" id="whois-input" placeholder="exemple.com"><button class="tool-btn" onclick="OsintTools.whoisLookup()">WHOIS</button><div class="tool-result" id="whois-result"></div></div>
              <div class="tool-card"><div class="tool-name">Reverse DNS (PTR)</div><div class="tool-desc">IP â†’ hostname</div><input class="tool-inp" id="rdns-input" placeholder="8.8.8.8"><button class="tool-btn" onclick="OsintTools.reverseDns()">RÃ©soudre PTR</button><div class="tool-result" id="rdns-result"></div></div>
              <div class="tool-card"><div class="tool-name">Subdomain Enumeration</div><div class="tool-desc">Tous les sous-domaines via crt.sh CT logs</div><input class="tool-inp" id="subdomain-input" placeholder="exemple.com"><button class="tool-btn" onclick="OsintTools.subdomainEnum()">Ã‰numÃ©rer</button><div class="tool-result" id="subdomain-result"></div></div>
            </div>
          </div>

          <!-- TLS -->
          <div class="tool-cat" id="cat-tls" style="display:none">
            <div class="tool-cat-title">ğŸ” TLS & Certificats</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">Certificate Transparency</div><div class="tool-desc">Tous les certificats via crt.sh (CT logs)</div><input class="tool-inp" id="crt-input" placeholder="%.exemple.com"><button class="tool-btn" onclick="OsintTools.certSearch()">Rechercher</button><div class="tool-result" id="crt-result"></div></div>
              <div class="tool-card"><div class="tool-name">TLS / SSL Info</div><div class="tool-desc">ValiditÃ©, CA, jours restants</div><input class="tool-inp" id="tls-input" placeholder="exemple.com"><button class="tool-btn" onclick="OsintTools.tlsInfo()">Analyser</button><div class="tool-result" id="tls-result"></div></div>
            </div>
          </div>

          <!-- THREAT -->
          <div class="tool-cat" id="cat-threat" style="display:none">
            <div class="tool-cat-title">â˜£ Threat Intelligence</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">URLScan.io</div><div class="tool-desc">Scans passÃ©s, screenshots, scores</div><input class="tool-inp" id="urlscan-input" placeholder="exemple.com ou https://..."><button class="tool-btn" onclick="OsintTools.urlscanSearch()">Rechercher</button><div class="tool-result" id="urlscan-result"></div></div>
              <div class="tool-card"><div class="tool-name">Liens externes Threat Intel</div><div class="tool-desc">Ouvrir dans les outils intÃ©grÃ©s</div><input class="tool-inp" id="ext-threat-input" placeholder="IP / domaine / hash">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.virustotal.com/gui/search/'+document.getElementById('ext-threat-input').value,'VirusTotal')">VirusTotal</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.abuseipdb.com/check/'+document.getElementById('ext-threat-input').value,'AbuseIPDB')">AbuseIPDB</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://otx.alienvault.com/indicator/ip/'+document.getElementById('ext-threat-input').value,'AlienVault OTX')">OTX</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://threatfox.abuse.ch/browse.php?search=ioc%3A'+document.getElementById('ext-threat-input').value,'ThreatFox')">ThreatFox</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://pulsedive.com/indicator/?ioc='+document.getElementById('ext-threat-input').value,'Pulsedive')">Pulsedive</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://bazaar.abuse.ch/browse.php?search=sha256_hash%3A'+document.getElementById('ext-threat-input').value,'MalwareBazaar')">MalwareBazaar</button>
                </div>
              </div>
            </div>
          </div>

          <!-- IMAGE -->
          <div class="tool-cat" id="cat-image" style="display:none">
            <div class="tool-cat-title">ğŸ–¼ OSINT Image & MÃ©dias</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">Recherche image inversÃ©e</div><div class="tool-desc">Chercher l'origine d'une image par URL</div><input class="tool-inp" id="imgrev-input" placeholder="https://exemple.com/photo.jpg"><div class="ext-btns"><button class="ext-btn" onclick="OsintTools.reverseImage('google')">Google Lens</button><button class="ext-btn" onclick="OsintTools.reverseImage('yandex')">Yandex</button><button class="ext-btn" onclick="OsintTools.reverseImage('tineye')">TinEye</button><button class="ext-btn" onclick="OsintTools.reverseImage('bing')">Bing Visual</button></div><div class="tool-result" id="imgrev-result"></div></div>
              <div class="tool-card"><div class="tool-name">Extraction EXIF</div><div class="tool-desc">MÃ©tadonnÃ©es EXIF locales (GPS, appareil, date) â€” aucun upload</div><input type="file" class="tool-file" id="exif-file" accept="image/*"><button class="tool-btn" onclick="OsintTools.extractExif()">Extraire EXIF</button><div class="tool-result" id="exif-result"></div></div>
              <div class="tool-card"><div class="tool-name">DÃ©tection IA / Deepfake</div><div class="tool-desc">Outils intÃ©grÃ©s de dÃ©tection</div>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.fotoforensics.com/','FotoForensics')">FotoForensics</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://29a.ch/photo-forensics/','Photo Forensics')">29a.ch</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://illuminarty.ai/','Illuminarty AI')">Illuminarty</button>
                </div>
              </div>
              <div class="tool-card"><div class="tool-name">GÃ©oloc image</div><div class="tool-desc">Identifier le lieu d'une photo</div>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://geospy.ai/','GeoSpy AI')">GeoSpy AI</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://picarta.ai/','Picarta')">Picarta</button>
                </div>
              </div>
              <div class="tool-card"><div class="tool-name">Recherche visage / KYC</div><div class="tool-desc">Attention â€” usage lÃ©gal uniquement</div>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://pimeyes.com/','PimEyes')">PimEyes</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.facecheck.id/','FaceCheck')">FaceCheck</button>
                </div>
              </div>
            </div>
          </div>

          <!-- SOCIAL -->
          <div class="tool-cat" id="cat-social" style="display:none">
            <div class="tool-cat-title">ğŸ‘¤ OSINT Social & IdentitÃ©</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">Username Search</div><div class="tool-desc">Username sur +300 plateformes</div><input class="tool-inp" id="username-input" placeholder="john_doe">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://whatsmyname.app/?q='+document.getElementById('username-input').value,'WhatsMyName')">WhatsMyName</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://usersearch.org/search/'+document.getElementById('username-input').value,'UserSearch')">UserSearch</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.social-searcher.com/social-mention/?q='+document.getElementById('username-input').value,'Social Searcher')">Social Searcher</button>
                </div>
              </div>
              <div class="tool-card"><div class="tool-name">Email OSINT</div><div class="tool-desc">MX, provider, jetable, sous-domaines</div><input class="tool-inp" id="email-input" placeholder="user@exemple.com"><button class="tool-btn" onclick="OsintTools.emailOsint()">Analyser</button><div class="tool-result" id="email-result"></div></div>
              <div class="tool-card"><div class="tool-name">GitHub OSINT</div><div class="tool-desc">Profil, repos, emails exposÃ©s, orgs</div><input class="tool-inp" id="github-input" placeholder="username"><button class="tool-btn" onclick="OsintTools.githubOsint()">Analyser</button><div class="tool-result" id="github-result"></div></div>
              <div class="tool-card"><div class="tool-name">RÃ©seaux sociaux directs</div><div class="tool-desc">AccÃ¨s rapide profils</div><input class="tool-inp" id="soc-direct-input" placeholder="username ou nom">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://twitter.com/'+document.getElementById('soc-direct-input').value,'Twitter/X')">Twitter/X</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.instagram.com/'+document.getElementById('soc-direct-input').value,'Instagram')">Instagram</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://github.com/'+document.getElementById('soc-direct-input').value,'GitHub')">GitHub</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.reddit.com/user/'+document.getElementById('soc-direct-input').value,'Reddit')">Reddit</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://t.me/'+document.getElementById('soc-direct-input').value,'Telegram')">Telegram</button>
                </div>
              </div>
              <div class="tool-card"><div class="tool-name">Google Dorks</div><div class="tool-desc">Recherche avancÃ©e</div><input class="tool-inp" id="dork-input" placeholder='site:linkedin.com "John Doe"'>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.google.com/search?q='+encodeURIComponent(document.getElementById('dork-input').value),'Google')">Google</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.bing.com/search?q='+encodeURIComponent(document.getElementById('dork-input').value),'Bing')">Bing</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://search.brave.com/search?q='+encodeURIComponent(document.getElementById('dork-input').value),'Brave')">Brave</button>
                </div>
              </div>
            </div>
          </div>

          <!-- GEO -->
          <div class="tool-cat" id="cat-geo" style="display:none">
            <div class="tool-cat-title">ğŸ“ GÃ©olocalisation</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">Geocoding / Reverse</div><div class="tool-desc">Adresse â†” coordonnÃ©es (Nominatim)</div><input class="tool-inp" id="geocode-input" placeholder="Paris, France ou 48.85,2.35"><button class="tool-btn" onclick="OsintTools.geocode()">Geocoder</button><div class="tool-result" id="geocode-result"></div></div>
              <div class="tool-card"><div class="tool-name">Analyse coordonnÃ©es GPS</div><div class="tool-desc">DÃ©cimal â†’ DMS, hÃ©misphÃ¨re</div><input class="tool-inp" id="gps-input" placeholder="48.8566, 2.3522"><button class="tool-btn" onclick="OsintTools.gpsAnalyze()">Analyser</button><div class="tool-result" id="gps-result"></div></div>
              <div class="tool-card"><div class="tool-name">MÃ©tÃ©o temps rÃ©el</div><div class="tool-desc">Conditions actuelles via Open-Meteo (sans clÃ©)</div><input class="tool-inp" id="weather-input" placeholder="Paris ou 48.85,2.35"><button class="tool-btn" onclick="OsintTools.weatherCheck()">MÃ©tÃ©o</button><div class="tool-result" id="weather-result"></div></div>
              <div class="tool-card"><div class="tool-name">Maps intÃ©grÃ©s</div><div class="tool-desc">Visualisation directe</div><input class="tool-inp" id="ext-geo-input" placeholder="48.8566,2.3522">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.openstreetmap.org/search?query='+document.getElementById('ext-geo-input').value,'OpenStreetMap')">OSM</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://satellites.pro/#'+document.getElementById('ext-geo-input').value,'Satellites.pro')">Satellite</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://zoom.earth/#view='+document.getElementById('ext-geo-input').value,'Zoom Earth')">Zoom Earth</button>
                </div>
              </div>
            </div>
          </div>

          <!-- BREACH -->
          <div class="tool-cat" id="cat-breach" style="display:none">
            <div class="tool-cat-title">ğŸ’€ Breaches & Dark Web</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">HaveIBeenPwned</div><div class="tool-desc">VÃ©rification fuites email</div><input class="tool-inp" id="hibp-input" placeholder="user@exemple.com"><button class="tool-btn" onclick="OsintTools.hibpCheck()">VÃ©rifier</button><div class="tool-result" id="hibp-result"></div></div>
              <div class="tool-card"><div class="tool-name">Breach databases</div><div class="tool-desc">AccÃ¨s direct aux bases de fuites</div><input class="tool-inp" id="breach-input" placeholder="email / domaine / username">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://intelx.io/?s='+document.getElementById('breach-input').value,'Intel X')">IntelX</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://dehashed.com/search?query='+document.getElementById('breach-input').value,'DeHashed')">DeHashed</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://leakcheck.io/search/'+document.getElementById('breach-input').value,'LeakCheck')">LeakCheck</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://pastebin.com/search?q='+document.getElementById('breach-input').value,'Pastebin')">Pastebin</button>
                </div>
              </div>
            </div>
          </div>

          <!-- CRYPTO -->
          <div class="tool-cat" id="cat-crypto" style="display:none">
            <div class="tool-cat-title">â‚¿ Crypto & Blockchain</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">Bitcoin Address</div><div class="tool-desc">Balance, transactions, historique</div><input class="tool-inp" id="btc-input" placeholder="1A1zP1..."><button class="tool-btn" onclick="OsintTools.btcLookup()">Analyser</button><div class="tool-result" id="btc-result"></div></div>
              <div class="tool-card"><div class="tool-name">Blockchain explorers</div><div class="tool-desc">Explorateurs intÃ©grÃ©s</div><input class="tool-inp" id="crypto-addr-input" placeholder="Adresse / TX hash">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://blockchair.com/search?q='+document.getElementById('crypto-addr-input').value,'Blockchair')">Blockchair</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://etherscan.io/search?f=1&q='+document.getElementById('crypto-addr-input').value,'Etherscan')">Etherscan</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://tronscan.org/#/search/'+document.getElementById('crypto-addr-input').value,'TronScan')">TronScan</button>
                </div>
              </div>
            </div>
          </div>

          <!-- MISC -->
          <div class="tool-cat" id="cat-misc" style="display:none">
            <div class="tool-cat-title">ğŸ›  Utilitaires</div>
            <div class="tools-grid">
              <div class="tool-card"><div class="tool-name">Wayback Machine</div><div class="tool-desc">DerniÃ¨re archive d'un site</div><input class="tool-inp" id="wayback-input" placeholder="https://exemple.com"><button class="tool-btn" onclick="OsintTools.waybackCheck()">VÃ©rifier</button><div class="tool-result" id="wayback-result"></div></div>
              <div class="tool-card"><div class="tool-name">User-Agent Decoder</div><div class="tool-desc">OS, navigateur, mobile, bot</div><input class="tool-inp" id="ua-input" placeholder="Mozilla/5.0..." style="font-size:9px"><button class="tool-btn" onclick="OsintTools.decodeUA()">DÃ©coder</button><div class="tool-result" id="ua-result"></div></div>
              <div class="tool-card"><div class="tool-name">Hash Identifier</div><div class="tool-desc">DÃ©tecte le type de hash</div><input class="tool-inp" id="hashid-input" placeholder="MD5/SHA1/SHA256..."><button class="tool-btn" onclick="OsintTools.hashIdentify()">Identifier</button><div class="tool-result" id="hashid-result"></div></div>
              <div class="tool-card"><div class="tool-name">Encode / Decode</div><div class="tool-desc">Base64, URL, Hex</div><input class="tool-inp" id="encode-input" placeholder="Texte"><div class="type-select-row"><button class="type-sel active" data-enc="b64e" onclick="App.selEnc(this)">B64â†‘</button><button class="type-sel" data-enc="b64d" onclick="App.selEnc(this)">B64â†“</button><button class="type-sel" data-enc="urle" onclick="App.selEnc(this)">URLâ†‘</button><button class="type-sel" data-enc="urld" onclick="App.selEnc(this)">URLâ†“</button><button class="type-sel" data-enc="hex" onclick="App.selEnc(this)">â†’Hex</button><button class="type-sel" data-enc="unhex" onclick="App.selEnc(this)">Hexâ†’</button></div><button class="tool-btn" onclick="OsintTools.encodeConvert()">Convertir</button><div class="tool-result" id="encode-result"></div></div>
              <div class="tool-card"><div class="tool-name">MÃ©ta-recherche</div><div class="tool-desc">AgrÃ©gateurs OSINT</div><input class="tool-inp" id="meta-input" placeholder="Terme de recherche">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://osint.sh/search/?q='+document.getElementById('meta-input').value,'OSINT.sh')">OSINT.sh</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://grep.app/search?q='+encodeURIComponent(document.getElementById('meta-input').value),'grep.app')">grep.app</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://archive.org/search?query='+encodeURIComponent(document.getElementById('meta-input').value),'Archive.org')">Archive.org</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://publicwww.com/websites/'+encodeURIComponent(document.getElementById('meta-input').value),'PublicWWW')">PublicWWW</button>
                </div>
              </div>
              <div class="tool-card"><div class="tool-name">Aviation OSINT</div><div class="tool-desc">Immatriculation, callsign, historique</div><input class="tool-inp" id="avi-osint-input" placeholder="F-GKXY / BAW123">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.flightradar24.com/'+document.getElementById('avi-osint-input').value,'FlightRadar24')">FR24</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.airframes.org/reg/'+document.getElementById('avi-osint-input').value,'Airframes')">Airframes</button>
                  <button class="ext-btn" onclick="OsintTools.openInPanel('https://www.planespotters.net/search?q='+document.getElementById('avi-osint-input').value,'PlaneSpotters')">PlaneSpotters</button>
                </div>
              </div>
            </div>
          </div>

        </div>

        <!-- OSINT Log panel -->
        <div class="osint-results">
          <div class="orpanel-title">ğŸ“‹ RÃ©sultats</div>
          <div class="or-toolbar"><button class="or-btn" onclick="App.clearOsintLog()">Vider</button><button class="or-btn" onclick="App.exportOsintLog()">Exporter</button></div>
          <div id="osint-log"></div>
        </div>
      </div>
    </div>

    <!-- GRAPH VIEW -->
    <div id="view-graph" class="view" style="display:none">
      <div class="graph-toolbar">
        <button class="map-btn" id="graph-phys-btn" onclick="GraphViz.togglePhysics()">âš› Physics ON</button>
        <button class="map-btn" onclick="GraphViz.reset()">âŠ• Reset</button>
        <span style="font-family:var(--mono);font-size:10px;color:var(--text2);padding:0 10px"><span id="graph-nodes">0</span> nÅ“uds Â· <span id="graph-links">0</span> liens</span>
      </div>
      <canvas id="graph-canvas"></canvas>
    </div>

    <!-- TABLE VIEW -->
    <div id="view-table" class="view" style="display:none;flex-direction:column">
      <div class="tbl-toolbar">
        <div class="tbl-filters">
          <button class="tbl-f active" onclick="TableViz.setFilter('all',this)">Tout</button>
          <button class="tbl-f" onclick="TableViz.setFilter('flight',this)">âœˆ Vols</button>
          <button class="tbl-f" onclick="TableViz.setFilter('incident',this)">âš  Incidents</button>
          <button class="tbl-f" onclick="TableViz.setFilter('infra',this)">ğŸ“¡ Infra</button>
          <button class="tbl-f" onclick="TableViz.setFilter('traffic',this)">ğŸ›£ Traffic</button>
        </div>
        <input class="tbl-search" placeholder="Filtrer..." oninput="TableViz.setSearch(this.value)">
        <span class="tbl-count" id="tbl-count">0 entitÃ©s</span>
      </div>
      <div id="tbl-scroll">
        <table id="main-tbl">
          <thead><tr>
            <th onclick="TableViz.sort('id')">ID</th><th onclick="TableViz.sort('type')">TYPE</th>
            <th>NOM</th><th onclick="TableViz.sort('lat')">LAT</th><th onclick="TableViz.sort('lng')">LNG</th>
            <th>DÃ‰TAILS</th><th onclick="TableViz.sort('ts')">HEURE</th>
          </tr></thead>
          <tbody id="tbl-body"></tbody>
        </table>
      </div>
    </div>

    <!-- Detail Panel -->
    <div id="detail-panel">
      <button class="dp-close" onclick="App.closeDetail()">âœ•</button>
      <div class="dp-title" id="dp-title">â€”</div>
      <div class="dp-grid" id="dp-grid"></div>
      <div id="dp-actions"></div>
    </div>

    <!-- Embedded iframe panel for OSINT tools -->
    <div id="osint-iframe-panel" style="display:none">
      <div class="iframe-header">
        <span id="osint-iframe-title">â€”</span>
        <div class="iframe-actions">
          <button class="iframe-btn" onclick="OsintTools.closePanel()">âœ• Fermer</button>
        </div>
      </div>
      <div class="iframe-notice">âš  Certains sites bloquent l'intÃ©gration (X-Frame-Options). <a id="iframe-external-link" href="#" target="_blank" rel="noopener">Ouvrir dans un onglet â†’</a></div>
      <iframe id="osint-iframe" sandbox="allow-scripts allow-same-origin allow-forms allow-popups" title="OSINT Tool"></iframe>
    </div>

  </main>

  <!-- RIGHT SIDEBAR -->
  <aside id="sidebar-right">
    <div class="sb-section"><div class="sb-label">Flux <span class="loading-pulse" id="feed-pulse"></span></div></div>
    <div id="entity-feed"></div>
  </aside>

  <!-- TIMELINE -->
  <footer id="timeline">
    <div class="tl-ctrl">
      <button class="tl-btn" onclick="Timeline.step(-3600)" title="-1h">â®</button>
      <button class="tl-btn" id="tl-play" onclick="Timeline.togglePlay()">â–¶</button>
      <button class="tl-btn" onclick="Timeline.step(3600)" title="+1h">â­</button>
    </div>
    <input type="range" id="tl-slider" min="0" max="86400" value="43200" oninput="Timeline.update(this.value)">
    <div class="tl-date" id="tl-date" style="font-family:var(--mono);font-size:9px;color:var(--text3);white-space:nowrap;padding:0 4px"></div>
    <div class="tl-time" id="tl-time">--:--:-- UTC</div>
    <button class="tl-btn" id="tl-live-btn" onclick="this.classList.toggle('active')" title="Temps rÃ©el" style="font-size:9px;padding:0 8px;width:auto">LIVE</button>
    <div class="tl-speed" onclick="Timeline.cycleSpeed()">Ã—<span id="tl-speed-val">1</span></div>
    <div class="tl-info">MÃ j: <span id="last-upd">â€”</span></div>
  </footer>
</div>

<!-- EXPORT MODAL -->
<div id="export-modal">
  <div class="modal-box">
    <div class="modal-title">â¬‡ Export donnÃ©es</div>
    <div class="export-opts">
      <div class="export-opt" onclick="App.exportJSON()"><span>{ }</span><div><b>JSON</b><br><small>Toutes les entitÃ©s + tracking</small></div></div>
      <div class="export-opt" onclick="App.exportCSV()"><span>ğŸ“Š</span><div><b>CSV</b><br><small>Compatible Excel/QGIS</small></div></div>
      <div class="export-opt" onclick="App.exportKML()"><span>ğŸŒ</span><div><b>KML</b><br><small>Google Earth / QGIS</small></div></div>
    </div>
    <button class="modal-cancel" onclick="App.closeExport()">Annuler</button>
  </div>
</div>

<div id="notif-container"></div>
<div id="disclaimer">
  <button onclick="this.parentElement.style.display='none'" style="float:right;background:none;border:none;color:var(--text3);cursor:pointer;font-size:12px">âœ•</button>
  <strong>âš  OSINT DÃ‰FENSIF UNIQUEMENT</strong>
  DonnÃ©es publiques exclusivement. Aucun scan actif. Usage lÃ©gal uniquement.
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<script src="js/state.js"></script>
<script src="js/utils.js"></script>
<script src="js/map.js"></script>
<script src="js/layers/aviation.js"></script>
<script src="js/layers/incidents.js"></script>
<script src="js/viz/graph.js"></script>
<script src="js/viz/table.js"></script>
<script src="js/osint/tools.js"></script>
<script src="js/timeline.js"></script>
<script src="js/app.js"></script>
</body>
</html>
