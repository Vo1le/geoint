<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geo Intelligence</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"/>
<link rel="stylesheet" href="css/main.css">
</head>
<body>
<div id="app">

  <!-- TOPBAR -->
  <header id="topbar">
    <div class="logo">Geo<span>¬∑Intelligence</span></div>
    <nav class="nav-tabs">
      <button class="nav-tab active" data-view="map" onclick="App.setView('map')"><span class="dot"></span>CARTE</button>
      <button class="nav-tab" data-view="osint" onclick="App.setView('osint')"><span class="dot"></span>OUTILS OSINT</button>
      <button class="nav-tab" data-view="graph" onclick="App.setView('graph')"><span class="dot"></span>GRAPHE</button>
      <button class="nav-tab" data-view="table" onclick="App.setView('table')"><span class="dot"></span>DONN√âES</button>
    </nav>
    <div class="topbar-right">
      <span class="badge badge-live" id="live-badge">‚¨§ LIVE</span>
      <span class="badge badge-api" id="api-badge">API OK</span>
      <button class="icon-btn" onclick="App.openExport()" title="Exporter">‚¨á</button>
      <button class="icon-btn" onclick="App.purgeCache()" title="Vider cache">üóë</button>
    </div>
  </header>

  <!-- LEFT SIDEBAR -->
  <aside id="sidebar-left">
    <div class="sb-section">
      <div class="sb-label">Recherche rapide</div>
      <div class="search-wrap">
        <span class="search-ic">üîç</span>
        <input id="search-input" class="search-inp" placeholder="IP, domaine, callsign, MMSI..." autocomplete="off">
        <button class="search-go" onclick="App.quickSearch()">‚Üí</button>
      </div>
    </div>

    <div class="sb-section">
      <div class="sb-label">Statistiques <span class="count" id="total-count">0</span></div>
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-val blue" id="s-flights">0</div><div class="stat-lbl">‚úà Vols</div></div>
        <div class="stat-card"><div class="stat-val red" id="s-incidents">0</div><div class="stat-lbl">‚ö† Incidents</div></div>
        <div class="stat-card"><div class="stat-val cyan" id="s-infra">0</div><div class="stat-lbl">üì° Infra</div></div>
        <div class="stat-card"><div class="stat-val orange" id="s-traffic">0</div><div class="stat-lbl">üõ£ Traffic</div></div>
      </div>
      <div class="risk-wrap">
        <div class="risk-head">
          <span class="risk-lbl">Score exposition</span>
          <button class="risk-info-btn" onclick="App.toggleRiskInfo()">?</button>
          <span class="risk-num" id="risk-num">0</span>
        </div>
        <div class="risk-track"><div class="risk-fill" id="risk-fill"></div></div>
        <div class="risk-scale">
          <span style="color:#3fb950">Faible</span>
          <span style="color:#e3b341">Mod√©r√©</span>
          <span style="color:#f78166">√âlev√©</span>
          <span style="color:#f85149">Critique</span>
        </div>
        <div id="risk-info" class="risk-info" style="display:none">
          <div class="ri-row"><span class="ri-dot" style="background:#3fb950"></span><b>0‚Äì25 Faible</b> ‚Äî Peu d'entit√©s, trafic normal, pas d'incident critique</div>
          <div class="ri-row"><span class="ri-dot" style="background:#e3b341"></span><b>26‚Äì50 Mod√©r√©</b> ‚Äî Incidents mineurs, densit√© a√©rienne notable, infra cloud visible</div>
          <div class="ri-row"><span class="ri-dot" style="background:#f78166"></span><b>51‚Äì75 √âlev√©</b> ‚Äî Incidents s√©v√®res, anomalies corr√©l√©es, concentration ASN anormale</div>
          <div class="ri-row"><span class="ri-dot" style="background:#f85149"></span><b>76‚Äì100 Critique</b> ‚Äî Multiples incidents critiques, exposition g√©ospatiale maximale</div>
          <div class="ri-formula">Score = (incidents√ó8 + s√©v√®res√ó15 + infra√ó0.2 + vols√ó0.05) / 2.5</div>
        </div>
      </div>
    </div>

    <div class="sb-section">
      <div class="sb-label">Couches carte</div>
      <div class="layer-row" onclick="App.toggleLayer('aviation')">
        <div class="layer-toggle on" id="lt-aviation"></div>
        <span class="layer-ic">‚úà</span>
        <div class="layer-info"><div class="layer-name">Trafic a√©rien</div><div class="layer-sub">OpenSky Network</div></div>
      </div>
      <div class="layer-row" onclick="App.toggleLayer('incidents')">
        <div class="layer-toggle on" id="lt-incidents"></div>
        <span class="layer-ic">‚ö†</span>
        <div class="layer-info"><div class="layer-name">Incidents g√©o</div><div class="layer-sub">GDACS / open data</div></div>
      </div>
      <div class="layer-row" onclick="App.toggleLayer('infra')">
        <div class="layer-toggle on" id="lt-infra"></div>
        <span class="layer-ic">üì°</span>
        <div class="layer-info"><div class="layer-name">Infrastructure cyber</div><div class="layer-sub">ASN / datacenters</div></div>
      </div>
      <div class="layer-row" onclick="App.toggleLayer('traffic')">
        <div class="layer-toggle" id="lt-traffic"></div>
        <span class="layer-ic">üõ£</span>
        <div class="layer-info"><div class="layer-name">Incidents routiers</div><div class="layer-sub">OSM Overpass</div></div>
      </div>
      <div class="layer-row" onclick="App.toggleLayer('heatmap')">
        <div class="layer-toggle" id="lt-heatmap"></div>
        <span class="layer-ic">üî•</span>
        <div class="layer-info"><div class="layer-name">Heatmap densit√©</div><div class="layer-sub">Visualisation</div></div>
      </div>
    </div>

    <div class="sb-section">
      <div class="sb-label">Filtres vols</div>
      <div class="filter-row">
        <label class="filter-lbl">Alt min <span id="alt-val">0 ft</span></label>
        <input type="range" class="frange" id="alt-filter" min="0" max="45000" value="0" oninput="App.setFilter('alt',this.value)">
      </div>
      <div class="filter-row">
        <label class="filter-lbl">Vitesse min <span id="spd-val">0 kts</span></label>
        <input type="range" class="frange" id="spd-filter" min="0" max="600" value="0" oninput="App.setFilter('spd',this.value)">
      </div>
      <div class="filter-row">
        <label class="filter-lbl">Max affich√©s</label>
        <select class="fselect" id="max-flights" onchange="App.setMaxFlights(this.value)">
          <option value="50">50 avions</option>
          <option value="100" selected>100 avions</option>
          <option value="200">200 avions</option>
          <option value="500">500 avions</option>
        </select>
      </div>
      <div id="tracking-row" class="tracking-row" style="display:none">
        <div class="track-indicator">üéØ Suivi actif : <strong id="track-name">‚Äî</strong></div>
        <button class="track-stop-btn" onclick="Aviation.stopTracking()">‚úï Arr√™ter</button>
      </div>
    </div>
  </aside>

  <!-- MAP VIEW -->
  <main id="main-area">
    <!-- MAP -->
    <div id="view-map" class="view active">
      <div id="map"></div>
      <div class="map-tr">
        <button class="map-btn" onclick="MapCtrl.resetView()">üåç Reset</button>
        <button class="map-btn" onclick="App.refreshAll()">‚Üª Actualiser</button>
        <div class="coord-box" id="coord-box">‚Äî / ‚Äî</div>
      </div>
      <div class="map-legend">
        <div class="leg-item"><span class="leg-dot" style="background:#58a6ff"></span>Vol</div>
        <div class="leg-item"><span class="leg-dot" style="background:#00ffcc;box-shadow:0 0 6px #00ffcc"></span>Suivi</div>
        <div class="leg-item"><span class="leg-dot" style="background:#f85149"></span>Incident</div>
        <div class="leg-item"><span class="leg-dot" style="background:#00d4aa"></span>Infra</div>
        <div class="leg-item"><span class="leg-dot" style="background:#f78166"></span>Traffic</div>
      </div>
    </div>

    <!-- OSINT TOOLS VIEW -->
    <div id="view-osint" class="view" style="display:none">
      <div class="osint-layout">
        <!-- Tool categories left -->
        <div class="osint-cats">
          <div class="cat-title">Cat√©gories</div>
          <button class="cat-btn active" data-cat="network" onclick="App.setCat('network')">üåê R√©seau & IP</button>
          <button class="cat-btn" data-cat="domain" onclick="App.setCat('domain')">üîó Domaines & DNS</button>
          <button class="cat-btn" data-cat="tls" onclick="App.setCat('tls')">üîê TLS & Certs</button>
          <button class="cat-btn" data-cat="threat" onclick="App.setCat('threat')">‚ò£ Threat Intel</button>
          <button class="cat-btn" data-cat="image" onclick="App.setCat('image')">üñº Images</button>
          <button class="cat-btn" data-cat="social" onclick="App.setCat('social')">üë§ OSINT Social</button>
          <button class="cat-btn" data-cat="geo" onclick="App.setCat('geo')">üìç G√©olocalisation</button>
          <button class="cat-btn" data-cat="breach" onclick="App.setCat('breach')"> üìÇ Breaches & Dark</button>
          <button class="cat-btn" data-cat="crypto" onclick="App.setCat('crypto')">‚Çø Crypto</button>
          <button class="cat-btn" data-cat="misc" onclick="App.setCat('misc')">üõ† Utilitaires</button>
        </div>

        <!-- Tool panel -->
        <div class="osint-panel">

          <!-- NETWORK & IP -->
          <div class="tool-cat" id="cat-network">
            <div class="tool-cat-title">üåê R√©seau & IP</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">IP Geolocation</div>
                <div class="tool-desc">G√©olocalise une IP, ASN, organisation, timezone</div>
                <input class="tool-inp" id="ip-geo-input" placeholder="8.8.8.8">
                <button class="tool-btn" onclick="OsintTools.ipGeo()">Analyser</button>
                <div class="tool-result" id="ip-geo-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Shodan InternetDB</div>
                <div class="tool-desc">Ports ouverts, CVEs, tags Shodan (sans cl√© API)</div>
                <input class="tool-inp" id="shodan-input" placeholder="8.8.8.8">
                <button class="tool-btn" onclick="OsintTools.shodanDB()">Scanner</button>
                <div class="tool-result" id="shodan-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">ASN Lookup</div>
                <div class="tool-desc">Infos sur un ASN : plages IP, organisation, pays</div>
                <input class="tool-inp" id="asn-input" placeholder="AS15169 ou 8.8.8.8">
                <button class="tool-btn" onclick="OsintTools.asnLookup()">Rechercher</button>
                <div class="tool-result" id="asn-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">BGP / Routing</div>
                <div class="tool-desc">Infos BGP, pr√©fixes, peers via bgpview.io</div>
                <input class="tool-inp" id="bgp-input" placeholder="AS15169 ou 8.8.0.0/24">
                <button class="tool-btn" onclick="OsintTools.bgpLookup()">Rechercher</button>
                <div class="tool-result" id="bgp-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Port Scanner (Shodan)</div>
                <div class="tool-desc">Services d√©tect√©s sur une IP via InternetDB</div>
                <input class="tool-inp" id="portscan-input" placeholder="1.1.1.1">
                <button class="tool-btn" onclick="OsintTools.portInfo()">Voir ports</button>
                <div class="tool-result" id="portscan-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Outils externes IP</div>
                <div class="tool-desc">Ouvrir dans les outils sp√©cialis√©s</div>
                <input class="tool-inp" id="ext-ip-input" placeholder="IP ou domaine">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.virustotal.com/gui/search/'+document.getElementById('ext-ip-input').value)">VirusTotal</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.abuseipdb.com/check/'+document.getElementById('ext-ip-input').value)">AbuseIPDB</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://threatintelligenceplatform.com/host-reputation?host='+document.getElementById('ext-ip-input').value)">TIP</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://bgp.he.net/ip/'+document.getElementById('ext-ip-input').value)">HE BGP</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://ipinfo.io/'+document.getElementById('ext-ip-input').value)">IPInfo</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.robtex.com/ip-lookup/'+document.getElementById('ext-ip-input').value)">Robtex</button>
                </div>
              </div>
            </div>
          </div>

          <!-- DOMAIN & DNS -->
          <div class="tool-cat" id="cat-domain" style="display:none">
            <div class="tool-cat-title">üîó Domaines & DNS</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">DNS Lookup complet</div>
                <div class="tool-desc">A, AAAA, MX, NS, TXT, SOA via DNS over HTTPS</div>
                <input class="tool-inp" id="dns-input" placeholder="exemple.com">
                <div class="type-select-row">
                  <button class="type-sel active" data-dtype="A" onclick="App.selDnsType(this)">A</button>
                  <button class="type-sel" data-dtype="AAAA" onclick="App.selDnsType(this)">AAAA</button>
                  <button class="type-sel" data-dtype="MX" onclick="App.selDnsType(this)">MX</button>
                  <button class="type-sel" data-dtype="NS" onclick="App.selDnsType(this)">NS</button>
                  <button class="type-sel" data-dtype="TXT" onclick="App.selDnsType(this)">TXT</button>
                  <button class="type-sel" data-dtype="SOA" onclick="App.selDnsType(this)">SOA</button>
                  <button class="type-sel" data-dtype="CNAME" onclick="App.selDnsType(this)">CNAME</button>
                </div>
                <button class="tool-btn" onclick="OsintTools.dnsLookup()">R√©soudre</button>
                <div class="tool-result" id="dns-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">WHOIS / Registrar</div>
                <div class="tool-desc">Registrant, dates, nameservers via rdap.org</div>
                <input class="tool-inp" id="whois-input" placeholder="exemple.com">
                <button class="tool-btn" onclick="OsintTools.whoisLookup()">WHOIS</button>
                <div class="tool-result" id="whois-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Reverse DNS</div>
                <div class="tool-desc">PTR record ‚Äî IP ‚Üí hostname</div>
                <input class="tool-inp" id="rdns-input" placeholder="8.8.8.8">
                <button class="tool-btn" onclick="OsintTools.reverseDns()">R√©soudre PTR</button>
                <div class="tool-result" id="rdns-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Subdomain Enum</div>
                <div class="tool-desc">D√©couverte sous-domaines via crt.sh</div>
                <input class="tool-inp" id="subdomain-input" placeholder="exemple.com">
                <button class="tool-btn" onclick="OsintTools.subdomainEnum()">√ânum√©rer</button>
                <div class="tool-result" id="subdomain-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Outils domaine externes</div>
                <div class="tool-desc">Acc√®s rapide aux outils sp√©cialis√©s</div>
                <input class="tool-inp" id="ext-domain-input" placeholder="exemple.com">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.virustotal.com/gui/domain/'+document.getElementById('ext-domain-input').value)">VirusTotal</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://dnsdumpster.com/')">DNSdumpster</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://securitytrails.com/domain/'+document.getElementById('ext-domain-input').value+'/dns')">SecurityTrails</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://mxtoolbox.com/SuperTool.aspx?action=mx%3a'+document.getElementById('ext-domain-input').value)">MXToolbox</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://web.archive.org/web/*/'+document.getElementById('ext-domain-input').value)">Wayback</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.shodan.io/search?query=hostname%3A'+document.getElementById('ext-domain-input').value)">Shodan</button>
                </div>
              </div>
            </div>
          </div>

          <!-- TLS & CERTS -->
          <div class="tool-cat" id="cat-tls" style="display:none">
            <div class="tool-cat-title">üîê TLS & Certificats</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">Certificate Transparency</div>
                <div class="tool-desc">Tous les certificats √©mis pour un domaine via crt.sh</div>
                <input class="tool-inp" id="crt-input" placeholder="%.exemple.com">
                <button class="tool-btn" onclick="OsintTools.certSearch()">Rechercher</button>
                <div class="tool-result" id="crt-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">TLS Info</div>
                <div class="tool-desc">D√©tails certificat, validit√©, CA, SAN</div>
                <input class="tool-inp" id="tls-input" placeholder="exemple.com">
                <button class="tool-btn" onclick="OsintTools.tlsInfo()">Analyser TLS</button>
                <div class="tool-result" id="tls-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Outils TLS externes</div>
                <div class="tool-desc">Tests SSL/TLS avanc√©s</div>
                <input class="tool-inp" id="ext-tls-input" placeholder="exemple.com">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.ssllabs.com/ssltest/analyze.html?d='+document.getElementById('ext-tls-input').value)">SSL Labs</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://crt.sh/?q='+document.getElementById('ext-tls-input').value)">crt.sh</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://tls.imirhil.fr/https/'+document.getElementById('ext-tls-input').value)">cryptcheck</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://sslshopper.com/ssl-checker.html#hostname='+document.getElementById('ext-tls-input').value)">SSL Shopper</button>
                </div>
              </div>
            </div>
          </div>

          <!-- THREAT INTEL -->
          <div class="tool-cat" id="cat-threat" style="display:none">
            <div class="tool-cat-title">‚ò£ Threat Intelligence</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">AbuseIPDB Check</div>
                <div class="tool-desc">V√©rifie si une IP est signal√©e malveillante</div>
                <input class="tool-inp" id="abuse-input" placeholder="1.2.3.4">
                <button class="tool-btn" onclick="OsintTools.abuseCheck()">V√©rifier</button>
                <div class="tool-result" id="abuse-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">VirusTotal Hash</div>
                <div class="tool-desc">Recherche un hash MD5/SHA1/SHA256</div>
                <input class="tool-inp" id="hash-input" placeholder="MD5 / SHA1 / SHA256">
                <button class="tool-btn" onclick="OsintTools.vtHash()">Analyser</button>
                <div class="tool-result" id="hash-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">URLScan.io</div>
                <div class="tool-desc">Scan une URL, capture screenshot, analyse DOM</div>
                <input class="tool-inp" id="urlscan-input" placeholder="https://exemple.com">
                <button class="tool-btn" onclick="OsintTools.urlscanSearch()">Rechercher</button>
                <div class="tool-result" id="urlscan-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Threat Intel externes</div>
                <div class="tool-desc">Plateformes de threat intelligence</div>
                <input class="tool-inp" id="ext-threat-input" placeholder="IP / domaine / hash">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.virustotal.com/gui/search/'+document.getElementById('ext-threat-input').value)">VirusTotal</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://otx.alienvault.com/indicator/ip/'+document.getElementById('ext-threat-input').value)">AlienVault OTX</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://threatfox.abuse.ch/browse.php?search=ioc%3A'+document.getElementById('ext-threat-input').value)">ThreatFox</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://urlhaus.abuse.ch/browse.php?search='+document.getElementById('ext-threat-input').value)">URLhaus</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://pulsedive.com/indicator/?ioc='+document.getElementById('ext-threat-input').value)">Pulsedive</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.hybrid-analysis.com/search?query='+document.getElementById('ext-threat-input').value)">Hybrid Analysis</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://bazaar.abuse.ch/browse.php?search=sha256_hash%3A'+document.getElementById('ext-threat-input').value)">MalwareBazaar</button>
                </div>
              </div>
            </div>
          </div>

          <!-- IMAGE OSINT -->
          <div class="tool-cat" id="cat-image" style="display:none">
            <div class="tool-cat-title">üñº OSINT Image & M√©dias</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">Recherche image invers√©e</div>
                <div class="tool-desc">Ouvrir une URL d'image dans les moteurs de recherche invers√©e</div>
                <input class="tool-inp" id="imgrev-input" placeholder="https://exemple.com/photo.jpg">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.reverseImage('google')">Google Images</button>
                  <button class="ext-btn" onclick="OsintTools.reverseImage('yandex')">Yandex</button>
                  <button class="ext-btn" onclick="OsintTools.reverseImage('tineye')">TinEye</button>
                  <button class="ext-btn" onclick="OsintTools.reverseImage('bing')">Bing Visual</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Extraction EXIF</div>
                <div class="tool-desc">Lit les m√©tadonn√©es EXIF d'une image (GPS, appareil, date)</div>
                <input type="file" class="tool-file" id="exif-file" accept="image/*">
                <button class="tool-btn" onclick="OsintTools.extractExif()">Extraire EXIF</button>
                <div class="tool-result" id="exif-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Analyse URL image</div>
                <div class="tool-desc">V√©rifie si une image a √©t√© signal√©e via VirusTotal</div>
                <input class="tool-inp" id="imgvt-input" placeholder="https://exemple.com/img.jpg">
                <button class="tool-btn" onclick="OsintTools.openExternal('https://www.virustotal.com/gui/search/'+document.getElementById('imgvt-input').value)">V√©rifier VT</button>
              </div>

              <div class="tool-card">
                <div class="tool-name">D√©tection IA / Deepfake</div>
                <div class="tool-desc">Outils de d√©tection d'images g√©n√©r√©es par IA</div>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.hivemoderation.com/deepfake-detection')">Hive Moderation</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://illuminarty.ai/')">Illuminarty</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.fotoforensics.com/')">FotoForensics</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://29a.ch/photo-forensics/')">Photo Forensics</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://exposed.ai/')">Exposed.ai</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">G√©olocalisation image</div>
                <div class="tool-desc">Outils pour localiser le lieu d'une photo</div>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://geospy.ai/')">GeoSpy AI</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.geoguessr.com/')">GeoGuessr</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://groundedai.company/products/geospy')">Grounded AI</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://picarta.ai/')">Picarta</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Recherche vid√©o / KYC</div>
                <div class="tool-desc">V√©rification d'identit√© et recherche vid√©o inverse</div>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.invid-project.eu/tools-and-services/invid-verification-plugin/')">InVID</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://findclone.ru/')">FindClone</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://pimeyes.com/')">PimEyes</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.facecheck.id/')">FaceCheck</button>
                </div>
              </div>
            </div>
          </div>

          <!-- SOCIAL OSINT -->
          <div class="tool-cat" id="cat-social" style="display:none">
            <div class="tool-cat-title">üë§ OSINT R√©seaux sociaux & Identit√©</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">Username Search</div>
                <div class="tool-desc">Trouve un username sur +300 r√©seaux sociaux</div>
                <input class="tool-inp" id="username-input" placeholder="john_doe">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://whatsmyname.app/?q='+document.getElementById('username-input').value)">WhatsMyName</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://sherlock-project.github.io/?username='+document.getElementById('username-input').value)">Sherlock</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://namechk.com/')">Namechk</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://usersearch.org/search/'+document.getElementById('username-input').value)">UserSearch</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.social-searcher.com/social-mention/?q='+document.getElementById('username-input').value)">Social Searcher</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Email OSINT</div>
                <div class="tool-desc">V√©rifie et enrichit une adresse email</div>
                <input class="tool-inp" id="email-input" placeholder="user@exemple.com">
                <button class="tool-btn" onclick="OsintTools.emailOsint()">Analyser</button>
                <div class="tool-result" id="email-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">GitHub OSINT</div>
                <div class="tool-desc">Profil, repos, organisations, emails expos√©s</div>
                <input class="tool-inp" id="github-input" placeholder="username">
                <button class="tool-btn" onclick="OsintTools.githubOsint()">Rechercher</button>
                <div class="tool-result" id="github-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Moteurs recherche avanc√©s</div>
                <div class="tool-desc">Dorks et recherche avanc√©e</div>
                <input class="tool-inp" id="dork-input" placeholder='site:linkedin.com "John Doe"'>
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.google.com/search?q='+encodeURIComponent(document.getElementById('dork-input').value))">Google</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://search.yahoo.com/search?p='+encodeURIComponent(document.getElementById('dork-input').value))">Yahoo</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.bing.com/search?q='+encodeURIComponent(document.getElementById('dork-input').value))">Bing</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://search.brave.com/search?q='+encodeURIComponent(document.getElementById('dork-input').value))">Brave</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">R√©seaux sociaux directs</div>
                <div class="tool-desc">Recherche directe sur les plateformes</div>
                <input class="tool-inp" id="soc-direct-input" placeholder="username ou nom">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://twitter.com/search?q='+document.getElementById('soc-direct-input').value)">Twitter/X</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.linkedin.com/search/results/all/?keywords='+document.getElementById('soc-direct-input').value)">LinkedIn</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.instagram.com/'+document.getElementById('soc-direct-input').value)">Instagram</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://github.com/'+document.getElementById('soc-direct-input').value)">GitHub</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://t.me/'+document.getElementById('soc-direct-input').value)">Telegram</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.reddit.com/user/'+document.getElementById('soc-direct-input').value)">Reddit</button>
                </div>
              </div>
            </div>
          </div>

          <!-- GEO -->
          <div class="tool-cat" id="cat-geo" style="display:none">
            <div class="tool-cat-title">üìç G√©olocalisation & Maps</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">Geocoding / Reverse</div>
                <div class="tool-desc">Adresse ‚Üí coordonn√©es ou coordonn√©es ‚Üí adresse (Nominatim)</div>
                <input class="tool-inp" id="geocode-input" placeholder="Paris, France ou 48.8566,2.3522">
                <button class="tool-btn" onclick="OsintTools.geocode()">Geocoder</button>
                <div class="tool-result" id="geocode-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Analyse coordonn√©es GPS</div>
                <div class="tool-desc">Convertit, analyse et affiche des coordonn√©es GPS</div>
                <input class="tool-inp" id="gps-input" placeholder="48.8566, 2.3522">
                <button class="tool-btn" onclick="OsintTools.gpsAnalyze()">Analyser</button>
                <div class="tool-result" id="gps-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Outils g√©o externes</div>
                <div class="tool-desc">Visualisation et analyse g√©ospatiale</div>
                <input class="tool-inp" id="ext-geo-input" placeholder="48.8566,2.3522">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://maps.google.com/?q='+document.getElementById('ext-geo-input').value)">Google Maps</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.openstreetmap.org/search?query='+document.getElementById('ext-geo-input').value)">OpenStreetMap</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.bing.com/maps?q='+document.getElementById('ext-geo-input').value)">Bing Maps</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://satellites.pro/#'+document.getElementById('ext-geo-input').value)">Satellites.pro</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.google.com/maps/@?api=1&map_action=pano&viewpoint='+document.getElementById('ext-geo-input').value)">Street View</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://zoom.earth/#view='+document.getElementById('ext-geo-input').value)">Zoom Earth</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">M√©t√©o & Risques naturels</div>
                <div class="tool-desc">Conditions m√©t√©o via Open-Meteo</div>
                <input class="tool-inp" id="weather-input" placeholder="Paris ou 48.85,2.35">
                <button class="tool-btn" onclick="OsintTools.weatherCheck()">M√©t√©o</button>
                <div class="tool-result" id="weather-result"></div>
              </div>
            </div>
          </div>

          <!-- BREACH -->
          <div class="tool-cat" id="cat-breach" style="display:none">
            <div class="tool-cat-title">Breaches & Dark W</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">HaveIBeenPwned</div>
                <div class="tool-desc">V√©rifie si un email est dans des fuites (API publique)</div>
                <input class="tool-inp" id="hibp-input" placeholder="user@exemple.com">
                <button class="tool-btn" onclick="OsintTools.hibpCheck()">V√©rifier</button>
                <div class="tool-result" id="hibp-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Intelligence fuites & Dark</div>
                <div class="tool-desc">Recherche dans les bases de fuites publiques</div>
                <input class="tool-inp" id="breach-input" placeholder="email / domaine / username">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://haveibeenpwned.com/account/'+document.getElementById('breach-input').value)">HIBP</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://intelx.io/?s='+document.getElementById('breach-input').value)">IntelX</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://dehashed.com/search?query='+document.getElementById('breach-input').value)">DeHashed</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://breachdirectory.org/')">BreachDirectory</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://leakcheck.io/search/'+document.getElementById('breach-input').value)">LeakCheck</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Paste Sites</div>
                <div class="tool-desc">Recherche sur Pastebin, GitHub Gist, etc.</div>
                <input class="tool-inp" id="paste-input" placeholder="email / IP / keyword">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://pastebin.com/search?q='+document.getElementById('paste-input').value)">Pastebin</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://gist.github.com/search?q='+document.getElementById('paste-input').value)">GitHub Gist</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://psbdmp.ws/search/'+document.getElementById('paste-input').value)">Pastebin Dump</button>
                </div>
              </div>
            </div>
          </div>

          <!-- CRYPTO -->
          <div class="tool-cat" id="cat-crypto" style="display:none">
            <div class="tool-cat-title">‚Çø Crypto & Blockchain</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">Bitcoin Address</div>
                <div class="tool-desc">Transactions, balance, historique d'une adresse BTC</div>
                <input class="tool-inp" id="btc-input" placeholder="1A1zP1eP5QGefi2DMPTfTL5SLmv7Divf...">
                <button class="tool-btn" onclick="OsintTools.btcLookup()">Analyser</button>
                <div class="tool-result" id="btc-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Blockchain explorers</div>
                <div class="tool-desc">Explorer les blockchains publiques</div>
                <input class="tool-inp" id="crypto-addr-input" placeholder="Adresse / TX hash">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.blockchain.com/explorer/search?search='+document.getElementById('crypto-addr-input').value)">Blockchain.com</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://blockchair.com/search?q='+document.getElementById('crypto-addr-input').value)">Blockchair</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://etherscan.io/search?f=1&q='+document.getElementById('crypto-addr-input').value)">Etherscan</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://tronscan.org/#/search/'+document.getElementById('crypto-addr-input').value)">TronScan</button>
                </div>
              </div>
            </div>
          </div>

          <!-- MISC -->
          <div class="tool-cat" id="cat-misc" style="display:none">
            <div class="tool-cat-title">üõ† Utilitaires OSINT</div>
            <div class="tools-grid">

              <div class="tool-card">
                <div class="tool-name">Wayback Machine</div>
                <div class="tool-desc">Archive d'un site web √† une date pass√©e</div>
                <input class="tool-inp" id="wayback-input" placeholder="https://exemple.com">
                <button class="tool-btn" onclick="OsintTools.waybackCheck()">V√©rifier archives</button>
                <div class="tool-result" id="wayback-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">User-Agent Decoder</div>
                <div class="tool-desc">D√©code et analyse un User-Agent string</div>
                <input class="tool-inp" id="ua-input" placeholder="Mozilla/5.0 (Windows...)" style="font-size:10px">
                <button class="tool-btn" onclick="OsintTools.decodeUA()">D√©coder</button>
                <div class="tool-result" id="ua-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">D√©codage Hash</div>
                <div class="tool-desc">Identifie le type d'un hash et tente le cracking</div>
                <input class="tool-inp" id="hashid-input" placeholder="5d41402abc4b2a76b9719d911017c592">
                <button class="tool-btn" onclick="OsintTools.hashIdentify()">Identifier</button>
                <div class="tool-result" id="hashid-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Encode / Decode</div>
                <div class="tool-desc">Base64, URL, HTML entities, hex</div>
                <input class="tool-inp" id="encode-input" placeholder="Texte √† encoder/d√©coder">
                <div class="type-select-row">
                  <button class="type-sel active" data-enc="b64e" onclick="App.selEnc(this)">B64 enc</button>
                  <button class="type-sel" data-enc="b64d" onclick="App.selEnc(this)">B64 dec</button>
                  <button class="type-sel" data-enc="urle" onclick="App.selEnc(this)">URL enc</button>
                  <button class="type-sel" data-enc="urld" onclick="App.selEnc(this)">URL dec</button>
                  <button class="type-sel" data-enc="hex" onclick="App.selEnc(this)">‚Üí Hex</button>
                </div>
                <button class="tool-btn" onclick="OsintTools.encodeConvert()">Convertir</button>
                <div class="tool-result" id="encode-result"></div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Recherche universelle</div>
                <div class="tool-desc">M√©ta-moteurs OSINT et agr√©gateurs</div>
                <input class="tool-inp" id="meta-input" placeholder="Terme de recherche">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://osint.sh/search/?q='+document.getElementById('meta-input').value)">OSINT.sh</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://search.carrot2.org/#/search/web/'+encodeURIComponent(document.getElementById('meta-input').value))">Carrot2</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.startpage.com/search?query='+encodeURIComponent(document.getElementById('meta-input').value))">Startpage</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://archive.org/search?query='+encodeURIComponent(document.getElementById('meta-input').value))">Archive.org</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://grep.app/search?q='+encodeURIComponent(document.getElementById('meta-input').value))">grep.app</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://publicwww.com/websites/'+encodeURIComponent(document.getElementById('meta-input').value))">PublicWWW</button>
                </div>
              </div>

              <div class="tool-card">
                <div class="tool-name">Aviation OSINT</div>
                <div class="tool-desc">Recherche immatriculation, callsign, appareil</div>
                <input class="tool-inp" id="avi-osint-input" placeholder="F-GKXY / BAW123 / A320">
                <div class="ext-btns">
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.flightradar24.com/'+document.getElementById('avi-osint-input').value)">FlightRadar24</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.airframes.org/reg/'+document.getElementById('avi-osint-input').value)">Airframes</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://www.planespotters.net/search?q='+document.getElementById('avi-osint-input').value)">PlaneSpotters</button>
                  <button class="ext-btn" onclick="OsintTools.openExternal('https://opensky-network.org/aircraft-database?ident='+document.getElementById('avi-osint-input').value)">OpenSky DB</button>
                </div>
              </div>
            </div>
          </div>

        </div>

        <!-- Results panel right -->
        <div class="osint-results">
          <div class="orpanel-title">üìã R√©sultats de session</div>
          <div class="or-toolbar">
            <button class="or-btn" onclick="App.clearOsintLog()">Vider</button>
            <button class="or-btn" onclick="App.exportOsintLog()">Exporter</button>
          </div>
          <div id="osint-log"></div>
        </div>
      </div>
    </div>

    <!-- GRAPH VIEW -->
    <div id="view-graph" class="view" style="display:none">
      <div class="graph-toolbar">
        <button class="map-btn" id="graph-phys-btn" onclick="GraphViz.togglePhysics()">‚öõ Physics ON</button>
        <button class="map-btn" onclick="GraphViz.reset()">‚äï Reset</button>
        <span style="font-family:var(--mono);font-size:10px;color:var(--text2);padding:0 10px">
          <span id="graph-nodes">0</span> n≈ìuds ¬∑ <span id="graph-links">0</span> liens ¬∑ Drag + Clic
        </span>
      </div>
      <canvas id="graph-canvas"></canvas>
    </div>

    <!-- TABLE VIEW -->
    <div id="view-table" class="view" style="display:none">
      <div class="tbl-toolbar">
        <div class="tbl-filters">
          <button class="tbl-f active" data-type="all" onclick="TableViz.setFilter('all',this)">Tout</button>
          <button class="tbl-f" data-type="flight" onclick="TableViz.setFilter('flight',this)">‚úà Vols</button>
          <button class="tbl-f" data-type="incident" onclick="TableViz.setFilter('incident',this)">‚ö† Incidents</button>
          <button class="tbl-f" data-type="infra" onclick="TableViz.setFilter('infra',this)">üì° Infra</button>
          <button class="tbl-f" data-type="traffic" onclick="TableViz.setFilter('traffic',this)">üõ£ Traffic</button>
        </div>
        <input class="tbl-search" placeholder="Filtrer..." oninput="TableViz.setSearch(this.value)">
        <span class="tbl-count" id="tbl-count">0 entit√©s</span>
      </div>
      <div id="tbl-scroll">
        <table id="main-tbl">
          <thead><tr>
            <th onclick="TableViz.sort('id')">ID</th>
            <th onclick="TableViz.sort('type')">TYPE</th>
            <th onclick="TableViz.sort('name')">NOM</th>
            <th onclick="TableViz.sort('lat')">LAT</th>
            <th onclick="TableViz.sort('lng')">LNG</th>
            <th>D√âTAILS</th>
            <th onclick="TableViz.sort('ts')">HEURE</th>
          </tr></thead>
          <tbody id="tbl-body"></tbody>
        </table>
      </div>
    </div>

    <!-- Detail Panel (shared) -->
    <div id="detail-panel">
      <button class="dp-close" onclick="App.closeDetail()">‚úï</button>
      <div class="dp-title" id="dp-title">‚Äî</div>
      <div class="dp-grid" id="dp-grid"></div>
      <div id="dp-actions"></div>
    </div>
  </main>

  <!-- RIGHT SIDEBAR (entity feed) -->
  <aside id="sidebar-right">
    <div class="sb-section"><div class="sb-label">Flux entit√©s <span class="loading-pulse" id="feed-pulse"></span></div></div>
    <div id="entity-feed"></div>
  </aside>

  <!-- TIMELINE -->
  <footer id="timeline">
    <div class="tl-ctrl">
      <button class="tl-btn" onclick="Timeline.step(-3600)">‚èÆ</button>
      <button class="tl-btn" id="tl-play" onclick="Timeline.togglePlay()">‚ñ∂</button>
      <button class="tl-btn" onclick="Timeline.step(3600)">‚è≠</button>
    </div>
    <input type="range" id="tl-slider" min="0" max="86400" value="43200" oninput="Timeline.update(this.value)">
    <div class="tl-time" id="tl-time">--:--:-- UTC</div>
    <div class="tl-speed" onclick="Timeline.cycleSpeed()">√ó<span id="tl-speed-val">1</span></div>
    <div class="tl-info">M√†j: <span id="last-upd">‚Äî</span></div>
  </footer>
</div>

<!-- EXPORT MODAL -->
<div id="export-modal">
  <div class="modal-box">
    <div class="modal-title">‚¨á Export donn√©es</div>
    <div class="export-opts">
      <div class="export-opt" onclick="App.exportJSON()"><span>{ }</span><div><b>JSON</b><br><small>Toutes les entit√©s</small></div></div>
      <div class="export-opt" onclick="App.exportCSV()"><span>üìä</span><div><b>CSV</b><br><small>Compatible Excel</small></div></div>
    </div>
    <button class="modal-cancel" onclick="App.closeExport()">Annuler</button>
  </div>
</div>

<div id="notif-container"></div>
<div id="disclaimer">
  <button onclick="this.parentElement.style.display='none'" style="float:right;background:none;border:none;color:var(--text3);cursor:pointer">‚úï</button>
  <strong>‚ö† Outils Public et l√©gal.</strong>
  Donn√©es publiques exclusivement. Aucun scan actif. RGPD safe.
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<script src="js/state.js"></script>
<script src="js/utils.js"></script>
<script src="js/map.js"></script>
<script src="js/layers/aviation.js"></script>
<script src="js/layers/incidents.js"></script>
<script src="js/layers/infra.js"></script>
<script src="js/layers/traffic.js"></script>
<script src="js/viz/graph.js"></script>
<script src="js/viz/table.js"></script>
<script src="js/osint/tools.js"></script>
<script src="js/timeline.js"></script>
<script src="js/app.js"></script>
</body>
</html>
